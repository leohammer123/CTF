# Natas21
```php 
function print_credentials() { /* {{{ */
    if($_SESSION and array_key_exists("admin", $_SESSION) and $_SESSION["admin"] == 1) {
    print "You are an admin. The credentials for the next level are:<br>";
    print "<pre>Username: natas22\n";
    print "Password: <censored></pre>";
    } else {
    print "You are logged in as a regular user. Login as an admin to retrieve credentials for natas22.";
    }
}
```
## In the experimenter page
```php
if(array_key_exists("submit", $_REQUEST)) {
    foreach($_REQUEST as $key => $val) {
    $_SESSION[$key] = $val;
    }
}
```
If you wanna trigger print_credentials(), you have to have a pair of value admin:1, so in the experimenter page you can post some data,and it'll sotre in your session,you can either use burp or postname to post the request,then get the origin page with the same session id.
flag:chG9fbe1Tq2eWVMgjYYD1MsfIvN461kJ
# Natas22
```php
 if(array_key_exists("revelio", $_GET)) {
    print "You are an admin. The credentials for the next level are:<br>";
    print "<pre>Username: natas23\n";
    print "Password: <censored></pre>";
    }
if(array_key_exists("revelio", $_GET)) {
    // only admins can reveal the password
    if(!($_SESSION and array_key_exists("admin", $_SESSION) and $_SESSION["admin"] == 1)) {
    header("Location: /");
    }
}
```
Because of we don't have the admin session so the code will add a location header which will redirect you to  http://natas22.natas.labs.overthewire.org/ ,we can use burp to view the http history.<br>
flag:D0vlad33nQF0Hz2EP255TP5wSW9ZsRSE
# Natas23
```php
if(array_key_exists("passwd",$_REQUEST)){
        if(strstr($_REQUEST["passwd"],"iloveyou") && ($_REQUEST["passwd"] > 10 )){
            echo "<br>The credentials for the next level are:<br>";
            echo "<pre>Username: natas24 Password: <censored></pre>";
        }
        else{
            echo "<br>Wrong!<br>";
        }
    }
```
In this level it requires a passwd longer than 10 characters and it have to  satisfied [strstr()](https://www.php.net/manual/en/function.strstr.php) funcion, it could be solved by padding some number or letter.<br>
flag:OsRmXFguozKpTZZ5X14zNO43379LZveg
# Natas24
```php 
 if(array_key_exists("passwd",$_REQUEST)){
        if(!strcmp($_REQUEST["passwd"],"<censored>")){
            echo "<br>The credentials for the next level are:<br>";
            echo "<pre>Username: natas25 Password: <censored></pre>";
        }
        else{
            echo "<br>Wrong!<br>";
        }
    }
```
In this code , the only entry point is the strcmp(), you can find the vulnerability in the [manual page](https://www.php.net/manual/zh/function.strcmp.php).
flag:GHF6X7YwACaYYssHVY05cFq83hRktl4c



